NEW
AUTO 3,1
*--------------------------------------

*************************************************************************
* APPLE /// SOS 1.3 SOURCE CODE FILE: DISK3.DATA.SRC
*************************************************************************
* ASSEMBLER: APPLE ][ 6502 ASSEMBLER from APPLE COMPUTER TOOLKIT

* PAGE
* GENERAL DATA:
*
PREVUNIT		.bs 1 ;PRIOR UNIT ACCESSED (FOR REPEAT)
PREVCMD			.bs 1 ;PRIOR CMD (FOR REPEAT)
*
ESAVE			.bs 1 ;SAVED E.REG
VBLSAVE			.bs 1 ;SAVED E.IER
INITFLAG		.da 00 ;<0 IS INITTED
				.do REV0ROM
ROMREV			.bs 1 ;0=REV0, <>0=REV1
				.fin
*
* MOTOR-UP TIMES PER COMMAND
T50MS			.eq $02 ; 50MS FOR MONTIMEH
T200MS			.eq $08 ;200 MS FOR MONTIMEH
T1SEC			.eq $27 ;1-SEC FOR MONTIMEH
*
MTIMES			.da 02,08,27 ;READ,WRITE,SENSE
*
* REP 40
* DRIVE TABLES:
*
DRIVESEL		.bs 4 ;NONZERO IF SELECTED
*
UPTIME			.bs 4 ;MOTOR RUNTIME SINCE STARTED
DRVTRACK		.bs 4 ;CURRENT HEAD POSITION
* PAGE
				.do REV0ROM ;ONLY IF SUPPORTING IT!
* JUMP TABLE TO MONITOR ROUTINES.
* THIS TABLE FILLED IN BY 'INIT'.
*
JMPTAB			.eq *
RDADR			jmp $0000
READ			jmp $0000
WRITE			jmp $0000
SEEK			jmp $0000
MSWAIT			jmp $0000
PRENIB			jmp $0000
POSTNIB			jmp $0000
*
REV0			.eq * ;REV0 ADDRESSES
				jmp $F1BD ;RDADR
				jmp $F148 ;READ
				jmp $F219 ;WRITE
				jmp $F400 ;SEEK
				jmp $F456 ;MSWAIT
				jmp $F2C6 ;PRENIB
				jmp $F311 ;POSTNIB
VSIZE			.eq *-REV0 ;TABLE SIZE
*
REV1			.eq * ;REV1 ADDRESSES
				jmp $F1B9 ;RDADR
				jmp $F148 ;READ
				jmp $F216 ;WRITE
				jmp $F400 ;SEEK
				jmp $F456 ;MSWAIT
				jmp $F2C4 ;PRENIB
				jmp $F30F ;POSTNIB
				.else ;FOR REV1 WE USE EQUATES
RDADR			.eq $F1B9 ;RDADR
READ			.eq $F148 ;READ
WRITE			.eq $F216 ;WRITE
SEEK			.eq $F400 ;SEEK
MSWAIT			.eq $F456 ;MSWAIT
PRENIB			.eq $F2C4 ;PRENIB
POSTNIB			.eq $F30F ;POSTNIB
				.fin

ZZEND			.eq *
ZZLEN			.eq *-ZZORG

* IFNE ZZLEN-LENDISK3
* FAIL 2,"SOSORG FILE IS INCORRECT FOR DISK3"
* FIN

*************************************************************************
* END OF APPLE /// SOS 1.3 SOURCE CODE FILE: DISK3.DATA.SRC
*************************************************************************




*--------------------------------------
MAN
SAVE /A3OSX.BUILD/SOS/SOS.S.DISK3.DAT
LOAD /A3OSX.BUILD/SOS/SOS.S
ASM
